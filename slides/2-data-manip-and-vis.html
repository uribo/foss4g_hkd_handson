<!DOCTYPE html>
<html>
  <head>
    <title>Rã‚’ä½¿ã£ãŸ åœ°ç†ç©ºé–“æƒ…å ±ãƒ‡ãƒ¼ã‚¿æ“ä½œã¨å¯è¦–åŒ–</title>
    <meta charset="utf-8">
    <meta name="author" content="ç“œç”Ÿ çœŸä¹Ÿ @u_ribo" />
    <script src="libs/htmlwidgets/htmlwidgets.js"></script>
    <script src="libs/jquery/jquery.min.js"></script>
    <link href="libs/leaflet/leaflet.css" rel="stylesheet" />
    <script src="libs/leaflet/leaflet.js"></script>
    <link href="libs/leafletfix/leafletfix.css" rel="stylesheet" />
    <link href="libs/leaflet-label/leaflet.label.css" rel="stylesheet" />
    <script src="libs/leaflet-label/leaflet.label.js"></script>
    <script src="libs/Proj4Leaflet/proj4-compressed.js"></script>
    <script src="libs/Proj4Leaflet/proj4leaflet.js"></script>
    <script src="libs/leaflet-binding/leaflet.js"></script>
    <script src="libs/pymjs/pym.v1.min.js"></script>
    <script src="libs/widgetframe-binding/widgetframe.js"></script>
    <link rel="stylesheet" href="ja.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Rã‚’ä½¿ã£ãŸ<br>åœ°ç†ç©ºé–“æƒ…å ±ãƒ‡ãƒ¼ã‚¿æ“ä½œã¨å¯è¦–åŒ–
## FOSS4GåŒ—æµ·é“ ãƒãƒ³ã‚ºã‚ªãƒ³ãƒ‡ã‚¤: <br>ãƒ¢ãƒ€ãƒ³ãªæ–¹æ³•ã§å­¦ã¶ã€Rã«ã‚ˆã‚‹åœ°ç†ç©ºé–“æƒ…å ±ãƒ‡ãƒ¼ã‚¿ã®å‡¦ç†
### ç“œç”Ÿ çœŸä¹Ÿ <span class="citation">@u_ribo</span>
### 2017å¹´6æœˆ30æ—¥

---





# ğŸ“œ æ¦‚è¦

ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’åˆ©ç”¨ã—ãŸãƒ‡ãƒ¼ã‚¿æ“ä½œã¨å¯è¦–åŒ–ã®æ–¹æ³•ã‚’å­¦ã³ã¾ã™ã€‚ã¯ã˜ã‚ã«ã€ç”¨æ„ã—ãŸãƒ‡ãƒ¼ã‚¿ã§ç°¡å˜ãªèª¬æ˜ã‚’ã—ã¾ã™ã€‚ãã®å¾Œã€åŒ—æµ·é“ã®ã‚ªãƒ¼ãƒ—ãƒ³ãƒ‡ãƒ¼ã‚¿ã‚’ç”¨ã„ã¦ã€å¿œç”¨çš„ãªå‡¦ç†ã‚’å®Ÿè·µã—ã¾ã™ã€‚

---
# ğŸ’¡ ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’å‘¼ã³å‡ºãã†


```r
# library(tidyverse)
library(dplyr) # ãƒ‡ãƒ¼ã‚¿æ“ä½œä¸€èˆ¬
library(sf) # åœ°ç†ç©ºé–“æƒ…å ±ãƒ‡ãƒ¼ã‚¿å‡¦ç†
library(leaflet) # åœ°å›³æç”»
```

ã“ã“ã§ã¯ä¸»è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã ã‘ã‚’å‘¼ã³å‡ºã—ã¾ã™ã€‚

--

ğŸ”– åå‰ç©ºé–“ã‚’åˆ©ç”¨ã—ãŸé–¢æ•°ã®åˆ©ç”¨


```r
package::function(...)
readr::read_csv("hoge.csv")
```

---
# ğŸ“¦ dplyrãƒ‘ãƒƒã‚±ãƒ¼ã‚¸

### ãƒ‡ãƒ¼ã‚¿æ“ä½œã‚’è¡Œã†ä¸Šã§ã®é‡è¦ãªæ©Ÿèƒ½ã‚’é–¢æ•°ã¨ã—ã¦æä¾›

&lt;https://github.com/tidyverse/dplyr&gt;

.pull-left[
- ãƒ‡ãƒ¼ã‚¿ã«å¯¾ã™ã‚‹ä¸»è¦ãªæ“ä½œ
    - é¸æŠ
    - æŠ½å‡º
    - åŠ å·¥
    - é›†è¨ˆ
    - ...
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿å–å¾—
]

.pull-right[
&lt;img src='img/fig-ch2-dplyr-data-manupulation.png' width=380px&gt;
]

---
# ğŸ“¦ sfãƒ‘ãƒƒã‚±ãƒ¼ã‚¸

### ãƒ¢ãƒ€ãƒ³ãªæ‰‹æ³•ã§å¤šæ§˜ãªåœ°ç†ç©ºé–“ãƒ‡ãƒ¼ã‚¿ã‚’æ‰±ã†

&lt;https://github.com/edzer/sfr&gt;

&lt;!-- å‚åŠ è€…ã«ã¨ã£ã¦ã¯ã“ã“ãŒå¤§äº‹ --&gt;

&lt;!-- æ¯”è¼ƒçš„ã‚·ãƒ³ãƒ—ãƒ«ï¼ã€gisãƒ‰ãƒ¡ã‚¤ãƒ³ãŒãªãã¦ã‚‚è‰¯ã„ã¨ã„ã†åˆ©ç‚¹ --&gt;


- Simple Featuresã‚’ã¯ã˜ã‚ã¨ã—ãŸå¤šæ§˜ãªãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã«å¯¾å¿œ
    - shapefile
    - kml, geojson, WKT/WKB
    - PostgreSQL
- **dplyr**ã¨åŒåã®é–¢æ•°ã«ã‚ˆã‚‹åœ°ç†ç©ºé–“ãƒ‡ãƒ¼ã‚¿ã®æ“ä½œ
- PostGISã®é–¢æ•°ã«è¿‘ã„ç©ºé–“æ“ä½œãƒ»è§£æãŒå¯èƒ½

---
# ğŸ“¦ leafletãƒ‘ãƒƒã‚±ãƒ¼ã‚¸

### ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªåœ°å›³æ“ä½œãŒå¯èƒ½

&lt;https://github.com/rstudio/leaflet&gt;

.pull-left[
- JavaScriptã§æ›¸ã‹ã‚ŒãŸã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
- ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å†…ã§æ´»èº
- ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã«ã‚ˆã‚‹æ‹¡å¼µãŒå¯èƒ½
    - **[leaflet.extra](https://github.com/bhaskarvk/leaflet.extras)**
    - **[leaflet.esri](https://github.com/bhaskarvk/leaflet.esri)**
    - **[leaflet.minicharts](https://github.com/rte-antares-rpackage/leaflet.minicharts)**
]

.pull-right[
<div id="htmlwidget-2b6e64774983bf90bb30" style="width:80%;height:331.2px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-2b6e64774983bf90bb30">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"maxNativeZoom":null,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"continuousWorld":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":null,"unloadInvisibleTiles":null,"updateWhenIdle":null,"detectRetina":false,"reuseTiles":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addPopups","args":[43.066,141.348,"Hi!",null,null,{"maxWidth":300,"minWidth":50,"maxHeight":null,"autoPan":true,"keepInView":false,"closeButton":false,"zoomAnimation":true,"closeOnClick":null,"className":""}]}],"setView":[[43.066,141.348],17,[]],"limits":{"lat":[43.066,43.066],"lng":[141.348,141.348]}},"evals":[],"jsHooks":[]}</script>
]


---
# ãƒ‡ãƒ¼ã‚¿ã®ç”¨æ„

- å¹³æˆ27å¹´å›½å‹¢èª¿æŸ» äººå£ç­‰åŸºæœ¬é›†è¨ˆ ç·å‹™çœçµ±è¨ˆå±€ &lt;http://www.stat.go.jp/data/kokusei/2015/&gt;




```r
df.pops &lt;- readr::read_rds("inst/data/pref01_population2015.rds")
```


```r
class(df.pops)
```

```
# [1] "tbl_df"     "tbl"        "data.frame"
```

```r
glimpse(df.pops) # dplyrã®ãƒ‡ãƒ¼ã‚¿å‡ºåŠ›é–¢æ•°
```

```
# Observations: 303
# Variables: 3
# $ city_code &lt;chr&gt; "01000", "01001", "01002", "01100", "01101", "01102"...
# $ city_name &lt;chr&gt; "åŒ—æµ·é“", "åŒ—æµ·é“å¸‚éƒ¨", "åŒ—æµ·é“éƒ¡éƒ¨", "æœ­å¹Œå¸‚", "æœ­å¹Œå¸‚ ä¸­å¤®åŒº", "æœ­å¹Œå¸‚ åŒ—åŒº",...
# $ value     &lt;dbl&gt; 5381733, 4395172, 986561, 1952356, 237627, 285321, 2...
```

---
# ãƒ‡ãƒ¼ã‚¿ã®ç”¨æ„

- å›½åœŸæ•°å€¤æƒ…å ± è¡Œæ”¿åŒºåŸŸãƒ‡ãƒ¼ã‚¿ (åŒ—æµ·é“) &lt;http://nlftp.mlit.go.jp/ksj/gml/datalist/KsjTmplt-N03.html&gt;


```r
df.pref01 &lt;- read_sf("inst/data/ksj_n0301.shp") %&gt;% 
  magrittr::set_names(c("pref_name", "city_name_", "city_name", "city_name_full", "city_code", "geometry"))
```


```r
class(df.pref01)
```

```
# [1] "sf"         "data.frame"
```

---
# sfã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ

.pull-left[
- Simple feature collection
    - 5å¤‰æ•° + geometry
- åœ°ç‰©ã‚¿ã‚¤ãƒ—: ãƒãƒªã‚´ãƒ³
- æ¬¡å…ƒ: XY
- ç¯„å›²
- ç©ºé–“å‚ç…§ã‚·ã‚¹ãƒ†ãƒ (epsg)
- æŠ•å½±æ³•
]

.pull-right[

```r
head(df.pref01, 3)
```
![](img/sf.png)
]

---
# æç”»ã—ã¦ã¿ã‚‹


```r
plot(df.pref01)
```

&lt;img src="2-data-manip-and-vis_files/figure-html/fig_2_plot_hkd_all-1.png" style="display: block; margin: auto;" /&gt;

---
# æç”»ã—ã¦ã¿ã‚‹

.pull-left[

```r
plot(df.pref01["city_code"])
```

&lt;img src="2-data-manip-and-vis_files/figure-html/fig_2_plot_hkd_city_code-1.png" style="display: block; margin: auto;" /&gt;
]

--
.pull-right[

```r
# çµæœã¯åŒã˜
df.pref01 %&gt;% 
  select(city_code) %&gt;% 
  plot()
```


```r
plot(st_geometry(df.pref01))
```
]


---
# select()ã«ã‚ˆã‚‹å¤‰æ•°ã®é¸æŠ

.pull-left[

```r
# å¤‰æ•°åã‚’å¼•æ•°ã§æŒ‡å®šã™ã‚‹
df.mod &lt;- df.pref01 %&gt;% select(city_name_full)
names(df.mod)
```

```
# [1] "city_name_full" "geometry"
```
]

--

.pull-right[

```r
plot(df.mod)
```

&lt;img src="2-data-manip-and-vis_files/figure-html/fig_2_plot_hkd_select-1.png" style="display: block; margin: auto;" /&gt;
]

---
# filter()ã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿æŠ½å‡º

.pull-left[

```r
# æ¡ä»¶ã«å¾“ã†ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡ºã™ã‚‹
df.mod &lt;- df.mod %&gt;% 
  # ã€Œæœ­å¹Œå¸‚ã€ã‚’å«ã‚“ã è¡Œã‚’å–ã‚Šå‡ºã™
  filter(grepl("æœ­å¹Œå¸‚", city_name_full))
```
]

.pull-right[

```r
plot(df.mod, 
     col = "gray", 
     axes = TRUE)
```

&lt;img src="2-data-manip-and-vis_files/figure-html/fig_2_plot_hkd_filter-1.png" style="display: block; margin: auto;" /&gt;
]

---
# mutate()ã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿ã®åŠ å·¥


```r
df.pref01$city_code[1] %&gt;% class()
```

```
# [1] "factor"
```

```r
# æ–‡å­—åˆ—å‹ã«å¤‰æ›
df.pref01$city_code[1] %&gt;% as.character() %&gt;% 
  class()
```

```
# [1] "character"
```


```r
# ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã®åˆ—ã«é©ç”¨
df.mod &lt;- df.pref01 %&gt;% 
  mutate(city_code = as.character(city_code))

df.mod$city_code[1] %&gt;% class()
```

```
# [1] "character"
```

---
# äººå£ãƒ‡ãƒ¼ã‚¿ã¨çµåˆ

2ã¤ã®ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ é–“ã§å…±é€šã™ã‚‹å¤‰æ•°ã‚’ç´ä»˜ã‘ã‚‹

.pull-left[

```r
df.mod &lt;- df.mod %&gt;% 
  left_join(df.pops, by = "city_code")

# çµåˆæ™‚ã®å¤‰æ•°åã¨ãƒ‡ãƒ¼ã‚¿å‹ã«æ³¨æ„
# df %&gt;% 
#   left_join(df.pops, by = "city_code")
# # Warning message:
# # Column `city_code` joining factor and character vector, coercing into character vector 
```
]

.pull-right[

```r
plot(df.mod["value"], 
     col = colormap::colormap("viridis"))
```

&lt;img src="2-data-manip-and-vis_files/figure-html/fig_2_plot_hkd_population-1.png" style="display: block; margin: auto;" /&gt;
]

---
class: bg-hlt, middle, center
# ğŸ‘ ã‚„ã£ã¦ã¿ã‚ˆã† ğŸ’ª

&lt;!-- 5åˆ†ãã‚‰ã„æ™‚é–“ã‚’å–ã£ã¦ã‚ã‚Œã“ã‚Œã‚„ã£ã¦ã‚‚ã‚‰ã† --&gt;

---
# sfãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«ã‚ˆã‚‹ã‚¸ã‚ªãƒ¡ãƒˆãƒªæ“ä½œ
  
- st_union: ã‚¸ã‚ªãƒ¡ãƒˆãƒªã®çµåˆ
- st_buffer: ç·©è¡å¸¯ã®ä»˜ä¸
- st_centroid: é‡å¿ƒç‚¹ã‚’æ±‚ã‚ã‚‹
- st_voronoi: ãƒœãƒ­ãƒã‚¤é ˜åŸŸã®ä½œæˆ
- st_contains, st_overlaps, st_within: åœ°ç‰©ã®é–¢ä¿‚
- ...
  

```r
st_union(df.pref01) %&gt;% 
  plot()

df.pref01["city_code"] %&gt;% 
  st_buffer(dist = 0.05) %&gt;% 
  plot()

st_centroid(df.pref01["city_code"]) %&gt;% 
  plot()
```

---
# leaflet


```r
base.map &lt;- leaflet() %&gt;% 
  addTiles()
```

--
- ã¯ã˜ã‚ã«`leaflet()`ã‚’ä½¿ã£ã¦ã€å¿…è¦ãªè¦ç´ ã‚’è¶³ã—ã¦ã„ã
- `addTiles()`ã¯OpenStreetMapã®ã‚¿ã‚¤ãƒ«ã‚’å‘¼ã³å‡ºã™é–¢æ•°
    - `addProviderTiles()`ã®å¼•æ•°ã«`names(providers)`ã§è¡¨ç¤ºã•ã‚Œã‚‹ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¿ã‚¤ãƒ«ã‚’å¤‰æ›´
    - `addTiles()`ä»»æ„ã®ã‚¿ã‚¤ãƒ«ã‚’åˆ©ç”¨ã€‚
        - å›½åœŸåœ°ç†é™¢ã‚¿ã‚¤ãƒ«ã‚’åˆ©ç”¨ã™ã‚‹æ–¹æ³• &lt;http://rpubs.com/yutannihilation/121912&gt;

---
# leafletã«sfã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æç”»ã•ã›ã‚‹


```r
base.map %&gt;% 
  addPolygons(data = df.pref01)
```

<div id="htmlwidget-d3020776eca70e0aa4bd" style="width:100%;height:504px;" class="widgetframe html-widget"></div>
<script type="application/json" data-for="htmlwidget-d3020776eca70e0aa4bd">{"x":{"url":"2-data-manip-and-vis_files/widgets/widget_unnamed-chunk-9.html","options":{"xdomain":"*","allowfullscreen":false}},"evals":[],"jsHooks":[]}</script>

---
# leafletã«sfã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æç”»ã•ã›ã‚‹

.pull-left[

```r
df.mod &lt;- df.pref01 %&gt;% 
  filter(city_name_ == "æœ­å¹Œå¸‚")
```


```r
base.map %&gt;% 
  addPolygons(data = df.mod) %&gt;% 
  addMarkers(data = st_centroid(df.mod),
             popup = ~city_name)
```
]

.pull-right[
<div id="htmlwidget-30dbec7626712ce50c9b" style="width:100%;height:504px;" class="widgetframe html-widget"></div>
<script type="application/json" data-for="htmlwidget-30dbec7626712ce50c9b">{"x":{"url":"2-data-manip-and-vis_files/widgets/widget_unnamed-chunk-12.html","options":{"xdomain":"*","allowfullscreen":false}},"evals":[],"jsHooks":[]}</script>
]

---
class: bg-hlt, middle, center
# ã‚ªãƒ¼ãƒ—ãƒ³ãƒ‡ãƒ¼ã‚¿ã‚’åˆ©ç”¨ã—ã‚ˆã†

---
# åŒ—æµ·é“ã‚ªãƒ¼ãƒ—ãƒ³ãƒ‡ãƒ¼ã‚¿ã‚«ã‚¿ãƒ­ã‚°

&lt;http://www.pref.hokkaido.lg.jp/ss/jsk/opendata/opendata.htm&gt;

- åŒ—æµ·é“ã¯ã‚ªãƒ¼ãƒ—ãƒ³ãƒ‡ãƒ¼ã‚¿ãŒå¤šã„
- åŒ—æµ·é“ã‚ªãƒ¼ãƒ—ãƒ³ãƒ‡ãƒ¼ã‚¿ã‚«ã‚¿ãƒ­ã‚°ã§ã¯ã€åŸºæœ¬çš„ã«**Creative Commonsã®è¡¨ç¤ºï¼ˆCC BYï¼‰**ã«å¾“ã†ã“ã¨ã§äºŒæ¬¡åˆ©ç”¨å¯èƒ½

---
# ã©ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã†?

- ã‚¦ã‚§ãƒ–ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã«ã‚ˆã‚Šä¸€è¦§ã‚’ç¢ºèª
     - ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°... ã‚¦ã‚§ãƒ–ãƒšãƒ¼ã‚¸ä¸Šã®ãƒ†ã‚­ã‚¹ãƒˆã‚„ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
     

```r
library(rvest)
```


```r
x &lt;- read_html("http://www.pref.hokkaido.lg.jp/ss/jsk/opendata/opendata.htm")
df.opd &lt;- x %&gt;% html_table(fill = TRUE) %&gt;% 
  .[[3]]
```




```r
df.opd %&gt;% View()
```

---
# è©³ç´°ãªè¦ç´ ï¼ˆãƒªãƒ³ã‚¯å…ˆã®URLï¼‰ã‚’å–å¾—


```r
x %&gt;% html_nodes(css = '#rs_contents &gt; p:nth-child(4) &gt; span &gt; strong')
# {xml_nodeset (1)}
# [1] &lt;strong&gt;åŒ—æµ·é“ã‚ªãƒ¼ãƒ—ãƒ³ãƒ‡ãƒ¼ã‚¿ã‚«ã‚¿ãƒ­ã‚°&lt;/strong&gt;
```

--

```r
x %&gt;% html_nodes(css = '#rs_contents &gt; p:nth-child(4) &gt; span &gt; strong') %&gt;% 
  html_text()
# åŒ—æµ·é“ã‚ªãƒ¼ãƒ—ãƒ³ãƒ‡ãƒ¼ã‚¿ã‚«ã‚¿ãƒ­ã‚°
```


```r
x %&gt;% html_nodes(css = '#open_data &gt; tbody &gt; tr:nth-child(222) &gt; td:nth-child(3) &gt; a') %&gt;% 
  html_text()
# [1] "æ£®æ—è¨ˆç”»é–¢ä¿‚è³‡æ–™ï¼ˆGISç”¨ãƒ‡ãƒ¼ã‚¿ï¼‰"
(link.url &lt;- x %&gt;% html_nodes(css = '#open_data &gt; tbody &gt; tr:nth-child(222) &gt; td:nth-child(3) &gt; a') %&gt;% 
  html_attr(name = "href"))
# [1] "http://www.pref.hokkaido.lg.jp/sr/srk/OPD.htm"
```

ãƒ–ãƒ©ã‚¦ã‚¶ã®é–‹ç™ºãƒ¢ãƒ¼ãƒ‰ã‚’ä½¿ã£ã¦selectorã€XPathã‚’å–å¾—ã™ã‚‹ã¨æ¥½

---
# æ£®æ—è¨ˆç”»é–¢ä¿‚è³‡æ–™ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰


```r
x &lt;- read_html(link.url)

x %&gt;% html_nodes(css= '#rs_contents &gt; div &gt; table &gt; tbody &gt; tr &gt; td:nth-child(2) &gt; p:nth-child(1) &gt; a:nth-child(9)') %&gt;%
  html_text()
# [1] "ç•™èŒ " "ç•™èŒ" 

x %&gt;% html_nodes(css= '#rs_contents &gt; div &gt; table &gt; tbody &gt; tr &gt; td:nth-child(2) &gt; p:nth-child(1) &gt; a:nth-child(9)') %&gt;%
  html_attr("href")
# [1] "https://www.fics.pref.hokkaido.lg.jp/FILE/2015/KMZ/09rumoi.zip"
# [2] "https://www.fics.pref.hokkaido.lg.jp/FILE/2015/GIS/09rumoi.zip"
```


```r
download.file("https://www.fics.pref.hokkaido.lg.jp/FILE/2015/GIS/09rumoi.zip",
              destfile = "inst/09rumoi.zip")
unzip(
  'inst/09rumoi.zip',
  exdir = "inst/"
)
```

---
class: bg-hlt, middle, center
# ğŸ‘ ã‚„ã£ã¦ã¿ã‚ˆã† ğŸ’ª
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"ratio": "16:9",
"highlightStyle": "github",
"highlightLines": true
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {window.dispatchEvent(new Event('resize'));});</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
  }
});
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
